# Simple Type Insert Tests

# Setup test tables
statement ok
CREATE TABLE users (
    id INTEGER,
    name VARCHAR,
    age SMALLINT,
    email VARCHAR,
    is_active BOOLEAN,
    created_at TIMESTAMP
);

statement ok
CREATE TABLE products (
    id INTEGER,
    name VARCHAR,
    price DECIMAL(3,2),
    quantity SMALLINT,
    weight DECIMAL(3,2),
    category VARCHAR
);

# Test basic insert
statement ok
INSERT INTO users (id, name, age, email, is_active, created_at)
VALUES (1, 'Alice', 25, 'alice@test.com', true, TIMESTAMP '2023-01-01 10:00:00');

# Verify insert
query ITIT
SELECT * FROM users ORDER BY id;
----
1 Alice 25 alice@test.com true 1672567200

# Test multiple row insert
statement ok
INSERT INTO users (id, name, age, email, is_active, created_at) VALUES
    (2, 'Bob', 30, 'bob@test.com', true, '2023-01-02 10:00:00'),
    (3, 'Charlie', 35, 'charlie@test.com', false, '2023-01-03 10:00:00');

# Verify multiple inserts
query ITIT
SELECT * FROM users ORDER BY id;
----
1 Alice 25 alice@test.com true 1672567200
2 Bob 30 bob@test.com true 1672653600
3 Charlie 35 charlie@test.com false 1672740000

# Test insert with NULL values
statement ok
INSERT INTO users (id, name, age, email, is_active, created_at)
VALUES (4, 'Dave', NULL, NULL, NULL, NULL);

# Test insert with partial columns
statement ok
INSERT INTO users (id, name, age)
VALUES (5, 'Eve', 28);

# Test insert with numeric types
statement ok
INSERT INTO products (id, name, price, quantity, weight, category)
VALUES (1, 'Product A', 10.99, 100, 1.5, 'Electronics');

# Verify product insert
query ITIT
SELECT * FROM products ORDER BY id;
----
1 Product A 10.99 100 1.50 Electronics

# Test multiple product inserts
statement ok
INSERT INTO products (id, name, price, quantity, weight, category) VALUES
    (2, 'Product B', 20.50, 50, 2.0, 'Books'),
    (3, 'Product C', 15.75, 75, 0.5, 'Electronics');

# Verify multiple product inserts
query ITIT
SELECT * FROM products ORDER BY id;
----
1 Product A 10.99 100 1.50 Electronics
2 Product B 20.50 50 2.00 Books
3 Product C 15.75 75 0.50 Electronics

# Test inserting with SELECT
statement ok
INSERT INTO products (id, name, price, quantity, weight, category)
SELECT id, name, 10.00, age, 1.00, email
FROM users
WHERE age IS NOT NULL;

# Verify insert from select
query ITIT
SELECT * FROM products ORDER BY id;
----
1 Product A 10.99 100 1.50 Electronics
1 Alice 10.00 25 1.00 alice@test.com
2 Product B 20.50 50 2.00 Books
2 Bob 10.00 30 1.00 bob@test.com
3 Product C 15.75 75 0.50 Electronics
3 Charlie 10.00 35 1.00 charlie@test.com
5 Eve 10.00 28 1.00 NULL

# Error Cases

# Test inserting invalid data type
statement error
INSERT INTO users (id, name, age) VALUES ('invalid', 'Grace', 'not_a_number');

# Test inserting into non-existent table
statement error
INSERT INTO nonexistent_table (id, name) VALUES (1, 'Test');

# Test inserting with wrong number of columns
statement error
INSERT INTO users (id, name, age) VALUES (1, 'Test');
